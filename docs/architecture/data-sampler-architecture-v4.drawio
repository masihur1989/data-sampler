<mxfile host="app.diagrams.net" modified="2026-02-04T18:44:00.000Z" agent="Devin" version="21.0.0" type="device">
  <diagram name="Data Sampler Architecture v4" id="data-sampler-arch-v4">
    <mxGraphModel dx="1600" dy="1600" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="Data Sampler Architecture v4" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#1a202c;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="600" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Excel File Sampling Application - Refactored with Pure Utility Functions &amp; Comprehensive Testing" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#718096;" vertex="1" parent="1">
          <mxGeometry x="300" y="55" width="800" height="20" as="geometry" />
        </mxCell>
        
        <!-- ==================== WORKFLOW OVERVIEW ==================== -->
        <mxCell id="workflow-label" value="DATA PROCESSING WORKFLOW" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#2d3748;" vertex="1" parent="1">
          <mxGeometry x="60" y="90" width="200" height="20" as="geometry" />
        </mxCell>
        
        <!-- Workflow Steps -->
        <mxCell id="step1" value="1. Upload" style="ellipse;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=2;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step2" value="2. Pre-process" style="ellipse;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=2;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="115" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step3" value="3. Sample" style="ellipse;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step4" value="4. Export" style="ellipse;whiteSpace=wrap;html=1;fillColor=#c6f6d5;strokeColor=#38a169;strokeWidth=2;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="600" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step5" value="5. Archive" style="ellipse;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="760" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        
        <!-- Workflow Arrows -->
        <mxCell id="wf-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#4a5568;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="185" y="135" as="sourcePoint" />
            <mxPoint x="255" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wf-arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#4a5568;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="135" as="sourcePoint" />
            <mxPoint x="435" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wf-arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#4a5568;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="525" y="135" as="sourcePoint" />
            <mxPoint x="595" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wf-arrow4" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#4a5568;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="685" y="135" as="sourcePoint" />
            <mxPoint x="755" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- ==================== API LAYER ==================== -->
        <mxCell id="layer1-label" value="API LAYER (FastAPI Routers)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#4299e1;" vertex="1" parent="1">
          <mxGeometry x="60" y="180" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="upload-api" value="&lt;b&gt;upload.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#718096&quot;&gt;POST /api/upload&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ebf8ff;strokeColor=#4299e1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="205" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="preprocess-api" value="&lt;b&gt;preprocess.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#718096&quot;&gt;POST /api/preprocess&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff5f7;strokeColor=#d53f8c;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="220" y="205" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="sample-api" value="&lt;b&gt;sample.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#718096&quot;&gt;POST /api/sample&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#faf5ff;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="360" y="205" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="export-api" value="&lt;b&gt;export.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#718096&quot;&gt;GET /api/export&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fff4;strokeColor=#38a169;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="500" y="205" width="120" height="45" as="geometry" />
        </mxCell>
        <mxCell id="archive-api" value="&lt;b&gt;archive.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#718096&quot;&gt;POST /api/archive&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fffaf0;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="640" y="205" width="120" height="45" as="geometry" />
        </mxCell>
        
        <!-- ==================== SERVICE LAYER ==================== -->
        <mxCell id="service-label" value="SERVICE LAYER (State Management)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#38a169;" vertex="1" parent="1">
          <mxGeometry x="60" y="280" width="250" height="20" as="geometry" />
        </mxCell>
        
        <!-- Service Container -->
        <mxCell id="service-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fff4;strokeColor=#38a169;strokeWidth=2;strokeDasharray=3 3;" vertex="1" parent="1">
          <mxGeometry x="60" y="305" width="880" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="file-service" value="&lt;b&gt;file_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;File Upload/Storage&lt;br&gt;Chunked Processing&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c6f6d5;strokeColor=#38a169;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="320" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="preprocessing-service" value="&lt;b&gt;preprocessing_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;PreprocessingService&lt;br&gt;PreprocessingConfig&lt;br&gt;QualityReport&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="320" width="150" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sampler-service" value="&lt;b&gt;sampler_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;SamplerService&lt;br&gt;ReservoirSampler&lt;br&gt;StratifiedReservoirSampler&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="400" y="320" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="export-service" value="&lt;b&gt;export_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;XLSX/CSV/JSON&lt;br&gt;Streaming Export&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c6f6d5;strokeColor=#38a169;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="580" y="320" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="archive-service" value="&lt;b&gt;archive_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Compression&lt;br&gt;Retention Policy&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="730" y="320" width="130" height="55" as="geometry" />
        </mxCell>
        
        <mxCell id="service-note" value="Services manage state (storing processed data, reports, metadata) and orchestrate utility functions" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#38a169;" vertex="1" parent="1">
          <mxGeometry x="80" y="385" width="500" height="15" as="geometry" />
        </mxCell>
        
        <!-- ==================== UTILITY LAYER (NEW) ==================== -->
        <mxCell id="utils-label" value="UTILITY LAYER (Pure Functions - preprocessing_utils.py)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#d53f8c;" vertex="1" parent="1">
          <mxGeometry x="60" y="440" width="350" height="20" as="geometry" />
        </mxCell>
        
        <!-- Utility Container -->
        <mxCell id="utils-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff5f7;strokeColor=#d53f8c;strokeWidth=2;strokeDasharray=3 3;" vertex="1" parent="1">
          <mxGeometry x="60" y="465" width="880" height="180" as="geometry" />
        </mxCell>
        
        <!-- Row 1: Analysis & Cleaning -->
        <mxCell id="utils-row1-label" value="Analysis &amp; Cleaning:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#d53f8c;" vertex="1" parent="1">
          <mxGeometry x="80" y="475" width="120" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="util-analyze" value="&lt;b&gt;analyze_data()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; dict&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="495" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-duplicates" value="&lt;b&gt;remove_duplicates()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; (df, count)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="195" y="495" width="115" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-missing" value="&lt;b&gt;handle_missing_values()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df, strategy -&gt; (df, count)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="325" y="495" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-whitespace" value="&lt;b&gt;trim_whitespace()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; df&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="495" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-empty-rows" value="&lt;b&gt;remove_empty_rows()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; (df, count)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="595" y="495" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-empty-cols" value="&lt;b&gt;remove_empty_columns()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; (df, list)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="730" y="495" width="130" height="40" as="geometry" />
        </mxCell>
        
        <!-- Row 2: Transformation & Filtering -->
        <mxCell id="utils-row2-label" value="Transformation &amp; Filtering:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#d53f8c;" vertex="1" parent="1">
          <mxGeometry x="80" y="545" width="150" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="util-convert" value="&lt;b&gt;convert_types()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; (df, dict)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="565" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-normalize" value="&lt;b&gt;normalize_columns()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df, cols -&gt; (df, dict)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="195" y="565" width="115" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-filter" value="&lt;b&gt;filter_data()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df, conditions -&gt; (df, warnings)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="325" y="565" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-select" value="&lt;b&gt;select_columns()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df, keep, drop -&gt; (df, dropped, warnings)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="565" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="util-stats" value="&lt;b&gt;generate_column_stats()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#718096&quot;&gt;df -&gt; dict&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fed7e2;strokeColor=#d53f8c;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="705" y="565" width="140" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="utils-note" value="All functions are pure (stateless) - take DataFrame input, return transformed DataFrame + metadata. Easy to test independently." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#d53f8c;" vertex="1" parent="1">
          <mxGeometry x="80" y="620" width="600" height="15" as="geometry" />
        </mxCell>
        
        <!-- ==================== SAMPLING ENGINE ==================== -->
        <mxCell id="sampling-label" value="SAMPLING ENGINE (5 Methods)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#805ad5;" vertex="1" parent="1">
          <mxGeometry x="60" y="670" width="220" height="20" as="geometry" />
        </mxCell>
        
        <!-- Sampling Container -->
        <mxCell id="sampling-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#faf5ff;strokeColor=#805ad5;strokeWidth=2;strokeDasharray=3 3;" vertex="1" parent="1">
          <mxGeometry x="60" y="695" width="880" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="sample-random" value="&lt;b&gt;Random&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Reservoir Sampling&lt;br&gt;O(n) time, O(k) space&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="710" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sample-stratified" value="&lt;b&gt;Stratified&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Two-pass approach&lt;br&gt;Proportional sampling&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="710" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sample-systematic" value="&lt;b&gt;Systematic&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Every nth record&lt;br&gt;Random start&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="380" y="710" width="130" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sample-cluster" value="&lt;b&gt;Cluster&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Random cluster selection&lt;br&gt;All members included&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="530" y="710" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="sample-weighted" value="&lt;b&gt;Weighted&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Probability-based&lt;br&gt;Weight column&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e9d8fd;strokeColor=#805ad5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="690" y="710" width="130" height="55" as="geometry" />
        </mxCell>
        
        <mxCell id="sampling-note" value="Memory-efficient algorithms optimized for large files (up to 150MB). Reservoir sampling ensures O(k) memory usage." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#805ad5;" vertex="1" parent="1">
          <mxGeometry x="80" y="775" width="500" height="15" as="geometry" />
        </mxCell>
        
        <!-- ==================== DATA LAYER ==================== -->
        <mxCell id="data-label" value="DATA LAYER (parser_service.py)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#dd6b20;" vertex="1" parent="1">
          <mxGeometry x="60" y="830" width="220" height="20" as="geometry" />
        </mxCell>
        
        <!-- Data Container -->
        <mxCell id="data-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fffaf0;strokeColor=#dd6b20;strokeWidth=2;strokeDasharray=3 3;" vertex="1" parent="1">
          <mxGeometry x="60" y="855" width="880" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="excel-parser" value="&lt;b&gt;ExcelParser&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;openpyxl read_only mode&lt;br&gt;Streaming row iteration&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="870" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="chunk-processing" value="&lt;b&gt;Chunk Processing&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;10,000 rows per chunk&lt;br&gt;Memory efficient&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="260" y="870" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="file-formats" value="&lt;b&gt;Supported Formats&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;.xlsx, .xls, .csv&lt;br&gt;Multiple sheets&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="440" y="870" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="temp-storage" value="&lt;b&gt;Temp Storage&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;24h retention&lt;br&gt;Auto cleanup&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="620" y="870" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="archive-storage" value="&lt;b&gt;Archive Storage&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;30 day retention&lt;br&gt;gzip compression&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#feebc8;strokeColor=#dd6b20;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="780" y="870" width="130" height="50" as="geometry" />
        </mxCell>
        
        <!-- ==================== TEST COVERAGE ==================== -->
        <mxCell id="test-label" value="TEST COVERAGE (94 Tests)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#2b6cb0;" vertex="1" parent="1">
          <mxGeometry x="60" y="960" width="200" height="20" as="geometry" />
        </mxCell>
        
        <!-- Test Container -->
        <mxCell id="test-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ebf8ff;strokeColor=#2b6cb0;strokeWidth=2;strokeDasharray=3 3;" vertex="1" parent="1">
          <mxGeometry x="60" y="985" width="880" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="test-utils" value="&lt;b&gt;test_preprocessing_utils.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;11 test classes&lt;br&gt;All utility functions&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bee3f8;strokeColor=#2b6cb0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="1000" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="test-service" value="&lt;b&gt;test_preprocessing_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;Service orchestration&lt;br&gt;State management&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bee3f8;strokeColor=#2b6cb0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="280" y="1000" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="test-sampler" value="&lt;b&gt;test_sampler_service.py&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;All 5 sampling methods&lt;br&gt;Integration tests&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bee3f8;strokeColor=#2b6cb0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="490" y="1000" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="test-coverage" value="&lt;b&gt;Coverage&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#718096&quot;&gt;94 tests passing&lt;br&gt;pytest framework&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bee3f8;strokeColor=#2b6cb0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="690" y="1000" width="130" height="50" as="geometry" />
        </mxCell>
        
        <!-- ==================== TECHNOLOGY STACK ==================== -->
        <mxCell id="tech-label" value="TECHNOLOGY STACK" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#2d3748;" vertex="1" parent="1">
          <mxGeometry x="60" y="1090" width="150" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="tech-python" value="Python 3.11+" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="1115" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-fastapi" value="FastAPI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="160" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-pandas" value="pandas" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="240" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-openpyxl" value="openpyxl" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-numpy" value="numpy" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="400" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-pydantic" value="pydantic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="480" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-pytest" value="pytest" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="560" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tech-poetry" value="Poetry" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#4a5568;strokeWidth=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="1115" width="70" height="30" as="geometry" />
        </mxCell>
        
        <!-- ==================== LEGEND ==================== -->
        <mxCell id="legend-label" value="LEGEND" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#2d3748;" vertex="1" parent="1">
          <mxGeometry x="60" y="1160" width="80" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-api" value="API Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ebf8ff;strokeColor=#4299e1;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="60" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-service" value="Service Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fff4;strokeColor=#38a169;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="150" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-utils" value="Utility Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff5f7;strokeColor=#d53f8c;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="240" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-sampling" value="Sampling" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#faf5ff;strokeColor=#805ad5;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="330" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-data" value="Data Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fffaf0;strokeColor=#dd6b20;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="420" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-test" value="Test Coverage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ebf8ff;strokeColor=#2b6cb0;strokeWidth=1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="510" y="1185" width="80" height="25" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
